#  组合式

Vue 3 引入了一个新的 API——**组合式 API**（Composition API），作为 Vue 2 中的**选项式 API**（Options API）的**补充**，而非替代。每种 API 都有其优势，以下我们主要探讨组合式 API 的一些优点：

### 1. **逻辑复用和组织** 🔄🗂️
- **组合逻辑**：组合式 API 允许更灵活地组合和重用逻辑代码。你可以在组件之间轻松共享和提取功能逻辑。
- **逻辑组织**：它也帮助开发者更好地组织代码。你可以将相同功能的代码组合在一起，而不是按照选项的类型（例如 `methods`, `data`, `computed`）进行组织。

### 2. **类型推导** 🚀🔍
- **TypeScript 支持**：组合式 API 由一开始就是为了更好的 TypeScript 支持而构建的，它能提供比选项式 API 更强大的类型推导。

### 3. **易于阅读和理解** 📘👀
- **代码阅读**：当组件变得较大或复杂时，相关的逻辑在选项式 API 中可能会分散在不同的位置，而组合式 API 允许你将同一块逻辑代码放在一起，提高代码的可读性和可维护性。

### 4. **更好的控制** 🕹️⚙️
- **响应式数据控制**：组合式 API 提供更细粒度的响应式数据控制。
- **生命周期控制**：它也允许你在应用生命周期的不同阶段更灵活地运行代码。

### 5. **按需引入** 📦➡️
- **Tree-shaking**：组合式 API 是基于函数的，只导入你需要的功能，有利于 Tree-shaking，从而减小最终的 bundle 大小。

### 示例比较 📝
- **选项式 API**
  ```javascript
  export default {
    data() { return { count: 0 } },
    computed: { double: function () { return this.count * 2 } },
    methods: { increment: function () { this.count++ } }
  }
  ```
- **组合式 API**
  ```javascript
  import { ref, computed } from "vue";

  export default {
    setup() {
      const count = ref(0);
      const double = computed(() => count.value * 2);
      const increment = () => { count.value++ };

      return { count, double, increment };
    }
  }
  ```
>这两个 API 的选择并非绝对的好与坏，而更多地依赖于项目和团队的需求。一些小型或简单的项目可能会更倾向于使用选项式 API，因为它简单直观；而对于需要大量逻辑复用和组织的大型项目，组合式 API 可能会是一个更好的选择。


***

## 🌟 **组合式 API 的小故事：奇妙的魔法箱子** 🎩✨

![](img/20231011191603.png)

**🏠 场景**：在一个神秘的魔法小镇上，有两位法师：老实务法师 Ollie（代表选项式 API）和创新法师 Connie（代表组合式 API）。

### 📜 **1. 传统的魔法书** 📘
Ollie 使用传统的大魔法书📜来施法，每种类型的魔法（如火🔥、水💧、风🌪️）都储存在书的不同章节中。

> _**解析**：这象征着选项式 API 的组织方式，将不同的逻辑（methods、data、computed）分隔在不同的选项中。_

### 🎩 **2. 神奇的魔法箱子** 🧙‍♂️
Connie 则拥有一个特殊的魔法箱子🎩。她可以从箱子里取出各种魔法元素（如火种子🔥、水珠💧、风符🍃）并根据需要自由组合它们，创造出新奇的魔法✨。

> _**解析**：这反映了组合式 API 的灵活性和组合能力。Connie 的各种魔法元素类似于 ref 和 computed，它们可以被自由组合，创建复杂的逻辑。_

### 🔄 **3. 魔法复用** 🔗
Ollie 在每次创造一个新的魔法时，都需要翻开魔法书，寻找各种类型的魔法并组合它们。而Connie 可以轻松复制已组合好的魔法元素并在其他地方复用它们。

> _**解析**：这突显了组合式 API 优秀的逻辑复用能力。_

### 🚀 **4. 专注于目标** 🎯
Ollie 虽然能成功施放所有魔法，但要经过多次翻书找到需要的各种元素。Connie 则将所需的魔法元素摆在桌上，一眼就能看到所有相关的元素，高效而专注。

> _**解析**：这体现了组合式 API 如何让相关逻辑更加集中和易于追踪。_

### 💼 **总结**
- Ollie 的方式（选项式 API）**虽然结构清晰，但在处理复杂魔法（组件）时可能较繁琐**。
- Connie 的方法（组合式 API）让她**更自由地组合、复用魔法元素，并专注于复杂的魔法制作**。

通过这个神奇的魔法小镇的故事，希望能帮助初学者更形象、轻松地理解 Vue 中的选项式 API 和组合式 API 的不同之处及各自的优势！ 🎉🚀📘